# MongoDB 4.2-4.4 Configuration
# Generated by mup

net:
  port: {{ .Net.Port }}
  bindIp: {{ .Net.BindIP }}
{{- if .Net.MaxIncomingConnections }}
  maxIncomingConnections: {{ .Net.MaxIncomingConnections }}
{{- end }}
{{- if .Net.TLS }}
  # MongoDB 4.2+ uses 'tls' naming (ssl still works but deprecated)
  tls:
    mode: {{ .Net.TLS.Mode }}
{{- if .Net.TLS.CertificateKeyFile }}
    certificateKeyFile: {{ .Net.TLS.CertificateKeyFile }}
{{- end }}
{{- if .Net.TLS.CAFile }}
    CAFile: {{ .Net.TLS.CAFile }}
{{- end }}
{{- end }}

storage:
  dbPath: {{ .Storage.DBPath }}
  journal:
    enabled: {{ .Storage.Journal.Enabled }}
{{- if .Storage.Engine }}
  engine: {{ .Storage.Engine }}
{{- end }}
{{- if .Storage.WiredTiger }}
  wiredTiger:
    engineConfig:
      cacheSizeGB: {{ .Storage.WiredTiger.EngineConfig.CacheSizeGB }}
{{- if .Storage.WiredTiger.CollectionConfig.BlockCompressor }}
    collectionConfig:
      blockCompressor: {{ .Storage.WiredTiger.CollectionConfig.BlockCompressor }}
{{- end }}
{{- end }}

systemLog:
  destination: {{ .SystemLog.Destination }}
{{- if .SystemLog.Path }}
  path: {{ .SystemLog.Path }}
{{- end }}
  logAppend: {{ .SystemLog.LogAppend }}

processManagement:
{{- if .ProcessManagement.Fork }}
  fork: {{ .ProcessManagement.Fork }}
{{- end }}
{{- if .ProcessManagement.PIDFilePath }}
  pidFilePath: {{ .ProcessManagement.PIDFilePath }}
{{- end }}

{{- if .Replication }}
replication:
  replSetName: {{ .Replication.ReplSetName }}
{{- if .Replication.OplogSizeMB }}
  oplogSizeMB: {{ .Replication.OplogSizeMB }}
{{- end }}
{{- end }}

{{- if .Sharding }}
sharding:
  clusterRole: {{ .Sharding.ClusterRole }}
{{- end }}

{{- if .Security }}
security:
  authorization: {{ .Security.Authorization }}
{{- if .Security.KeyFile }}
  keyFile: {{ .Security.KeyFile }}
{{- end }}
{{- end }}

{{- if .SetParameter }}
setParameter:
{{- range $key, $value := .SetParameter }}
  {{ $key }}: {{ $value }}
{{- end }}
{{- end }}
